***Full Stack Web Application Framework***

*생활코딩 next.js 강의 정리

- front & back (full stack)
- server side rendering : server 쪽에서 js가 실행되고 브라우저는 완성된 html 전송
- 13이상에 추가된 App router 기능 - server component 개념

[프로젝트 설치 및 실행 링크 ]

[Next.js 13 - 1. 설치와 실행](https://www.youtube.com/watch?v=smAU6-ZdcoQ)

[터미널 명령어 모음]

```

npm run dev //서버 실행 명령어
npm build start 
npx json-server --port 9999 --watch db.json // json 데이터 파일 생성 및 포트 열기 
```

- 최소생성시에 TypeScript → Y로 선택 → tsx로 생성됨 (N이면 js로 생성됨)
- src/app 아래에 main 뼈대가 되는 파일 생성됨
    
    → layout.tsx, page.tsx
    

```tsx
//layout.tsx

export const metadata: Metadata = {
  title: 'web tutorials',
  description: 'Generated by it1451',
}

export default async function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  
const resp = await fetch(process.env.API_URL+"topics", { cache : 'no-store'});
const topics = await resp.json();
  return (
    <html>
      <body>
        <h1><Link href='/'>WEB</Link></h1>
        <ol>
          { topics.map((topic)=>{
            return <li key={topic.id}><Link href={`/read/${topic.id}`}>{topic.title}</Link></li>
          })}
        </ol>
        {children}
        <Control />
        </body>
    </html>
  )
}
```

```tsx
//page.tsx

export default function Home() {
  return (
    <>
      <h2>Welcome</h2>
      Hello, WEB~<br></br>
      <img src='000010570008.jpg'></img>
    </>
  )
}
```

화면 컨트롤을 위한 Control.tsx

```tsx
"use client"
import Link from 'next/link';
import { useParams } from 'next/navigation';
import { useRouter } from 'next/navigation';

export function Control() {
  const params = useParams();
  const router = useRouter();
  const id = params.id;
  
  return (
    <ul>
      <li><Link href='/create'>create</Link></li>
      { id ? <>
        <li><Link href={'/update/'+id} >update</Link></li>
      <li><input type='button' value='delete' onClick={()=>{
        const options = {method:'DELETE'};
       fetch(`http://localhost:9999/topics/`+id, options)
       .then(res=>res.json())
       .then(result => {
              
                router.push(`/read/${id}`);
                router.refresh();
       })
      }}></input></li>
      </> : null}
      
    </ul>
  );
}
```

http://localhost:3000/ 접속시,

<img width="764" alt="스크린샷 2023-09-08 오후 4 28 54" src="https://github.com/kjennn/nextApp/assets/74332305/3db903f6-f1e6-421a-87b6-12efdbbbca68">


## 적용한 기능

- 글 목록 list → 이때는 create 기능만 보임 (화면 컨트롤)
- 글 목록 클릭시 해당 글 상세보기 → create, update, delete 기능 모두 보임 (화면 컨트롤)
- 상세보기 수정
- 해당 글 삭제

## 패키지

- 
    
   <img width="278" alt="스크린샷 2023-09-08 오후 4 42 42" src="https://github.com/kjennn/nextApp/assets/74332305/a01fbafd-d0bd-466a-927b-768171fffe44">

    

## 신기한 기능

1. App Router
    - src/app 아래에 생성된 패키지 대로 화면 호출
        
        (이전에 나는 thymeleaf 쓸 때, modelAttribute 등으로 GetMapping 하여 화면과 연결해야 했다. /view 등으로 통일..)
        
        - src/app/create
            
            
           <img width="257" alt="스크린샷 2023-09-08 오후 4 34 23" src="https://github.com/kjennn/nextApp/assets/74332305/e61fa0ab-6433-487c-89dd-857f39bfa950">

            
            ```tsx
            "use client" //클라이언트 로 사용하겠다. 안쓰면 서버사이드로 .
            
            import { useRouter } from "next/navigation";
            
            export default function Create(){
                const router = useRouter(); //앱 라우터 기능
                return (
                    <form onSubmit={(e)=>{
                        e.preventDefault(); //버튼 누르면 바로 리다이렉트되니 막기
                        const title = e.target.title.value;
                        const body = e.target.body.value;
                        const options = {
                            method : 'POST',
                            headers: {
            
                                'Content-Type' : 'application/json'
                            },
                            body: JSON.stringify({title, body})
                        }
            					//fetch 사용
                        fetch(process.env.NEXT_PUBLIC_API_URL+`topics`, options)
                        .then(res=>res.json())
                        .then(result =>{
                            console.log(result);
                            const lastId = result.id;
                            router.refresh(); //refresh뭐엿지?
                            router.push(`/read/${lastId}`); //post 후 저장된 id 다시 조회
                        })
                    }}>
                        <p>
                            <input type="text" name="title" placeholder="title"></input>
                        </p>
                        <p>
                            <textarea name="body" placeholder="body"></textarea>
                        </p>
                        <p>
                            <input type="submit" value="create"></input>
                        </p>
                    </form>
                )
            }
            ```
            
        - scr/app/read/[id]
